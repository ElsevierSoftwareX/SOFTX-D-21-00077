<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PND: DSN-MD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PND
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">DSN-MD </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Differential Solver Neuralnet MD</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Build Command</h1>
<p>Use CMake to build the target <code>pnd_example</code>. This is binary for predicting energies using auto gradient using hamiltonian. <code>cmake --build . --config Release</code></p>
<h1><a class="anchor" id="autotoc_md2"></a>
Input Parameters</h1>
<p>All system input parameters go into pmd.in</p><ul>
<li>The first line is vproc[3]</li>
<li>The second line is InitUcell[3]</li>
<li>Density</li>
<li>Initial Temperature</li>
<li>DeltaT or time step</li>
<li>Number of warmup steps for MD - Results from these steps will not be considered for any trainig purpose. The purpose of this step to bring the system to active state</li>
<li>Step Average - This is the number of steps to perform MD for before printing the state of the system to console</li>
<li>Number of steps to perform pre-training</li>
<li>Number of steps to perform main-training after pre-trainig</li>
<li>Epochs for pre-training</li>
<li>Epochs for main-trainig</li>
</ul>
<p>The following is an example</p>
<div class="fragment"><div class="line">1 1 1   # Cell size, i.e., dimensions of the parallel-piped system along (x,y,z)       </div>
<div class="line">2 2 2   # Spatial decomposition, i.e., number of subsystems that will be assigned</div>
<div class="line">          to MPI processes (l.b.h)</div>
<div class="line">0.18    # Density or inter-atomic spacing</div>
<div class="line">0.7     # Initial temperature</div>
<div class="line">0.01    # The shortest time step for which trajectories must be computed</div>
<div class="line">130     # Time at which the system reaches its relaxation state</div>
<div class="line">1       # Interval to display output log </div>
<div class="line">25      # Time steps to predict </div>
<div class="line">50000   # Training epochs for pre-training</div>
<div class="line">200000  # Training epochs </div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3"></a>
Build on USC HPC</h1>
<p>(The following steps are implemented in the <code>build_run_PND_Discovery.sh</code> file. Details provided here)</p>
<p>Create a compressed source coude file using the follwing command <code>tar -cvzf PND.tgz PND/</code></p>
<p>To build on HPC you will need to load the offered python module with the folling commands. </p><div class="fragment"><div class="line">module purge</div>
<div class="line">module load usc</div>
<div class="line">module load cuda/10.1.243 python/3.7.6 cmake/3.16.2 cudnn/8.0.2-10.1</div>
</div><!-- fragment --><p> The next step is to use CMake to build the target</p>
<div class="fragment"><div class="line">cds2 # change into your scratch directory</div>
<div class="line"> </div>
<div class="line">rm -rf run_PND</div>
<div class="line"> </div>
<div class="line">mkdir run_PND; cd run_PND</div>
<div class="line"> </div>
<div class="line">cp ~/PND.tgz ./</div>
<div class="line"> </div>
<div class="line">tar -xzvf PND.tgz </div>
<div class="line"> </div>
<div class="line">cd PND/</div>
<div class="line"> </div>
<div class="line">mkdir build; cd build</div>
<div class="line"> </div>
<div class="line">python3 -c &#39;import torch ; print(torch.utils.cmake_prefix_path)&#39;</div>
<div class="line"> </div>
<div class="line">CC=gcc CXX=g++ cmake -DCMAKE_PREFIX_PATH=&#39;/spack/apps/linux-centos7-x86_64/gcc-8.3.0/python-3.7.6-dd2am3dyvlpovhd4rizwfzc45wnsajxf/lib/python3.7/site-packages/torch/share/cmake;/usr/lib64&#39; ../</div>
<div class="line"> </div>
<div class="line">cmake --build . --config Release</div>
<div class="line"> </div>
<div class="line">./pnd_example</div>
</div><!-- fragment --><p>copy the sbatch file <code>sbatch_PND.sh</code> to the directory level containing <a class="el" href="class_p_n_d.html">PND</a> and run it. This script requests for resources, compresses the source code and runs the build commands listed in <code>build_run_PND_Discovery.sh</code>.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Build note on Intel devcloud</h1>
<div class="fragment"><div class="line">cmake .. -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=dpcpp -DCMAKE_PREFIX_PATH=$PWD/../libtorch/ </div>
</div><!-- fragment --><p> and edit CMakeFiles/grad_lap.dir/flags.make</p>
<div class="fragment"><div class="line"># compile CXX with /opt/intel/inteloneapi/compiler/latest/linux/bin/dpcpp</div>
<div class="line">CXX_FLAGS =   -D_GLIBCXX_USE_CXX11_ABI=0   -D_GLIBCXX_USE_CXX11_ABI=0  -Wall -Wextra -Wno-unused-parameter -Wno-missing-field-initializers -Wno-write-strings -Wno-unknown-pragmas -Wno-missing-braces -openmp -std=gnu++14</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
